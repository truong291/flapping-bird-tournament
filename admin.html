<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flapping Bird Tournament - Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #1a1a1a;
            color: #fff;
            font-family: 'Press Start 2P', cursive;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .content-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        .page-title {
            text-align: center;
            color: #ffd700;
            margin: 20px 0;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .login-section {
            text-align: center;
            margin: 50px 0;
        }

        .connect-btn {
            background: #ffd700;
            color: #2d7b82;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .connect-btn:hover {
            background: #ffed4a;
            transform: translateY(-2px);
        }

        .admin-content {
            display: none;
        }

        .stats-section {
            background: #2d7b82;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-label {
            font-size: 10px;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 14px;
        }

        .bonus-input {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #ffd700;
            color: #fff;
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            width: 200px;
            margin-top: 10px;
        }

        .control-section {
            background: #2d7b82;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .control-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 5px;
        }

        .control-btn {
            background: #ffd700;
            color: #2d7b82;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 10px;
        }

        .control-btn:hover {
            background: #ffed4a;
        }

        .control-btn.active {
            background: #ff4444;
        }

        .note-input {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #ffd700;
            color: #fff;
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            width: 100%;
            margin-top: 10px;
        }

        .settings-section {
            background: #2d7b82;
            padding: 20px;
            border-radius: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            background: rgba(0, 0, 0, 0.2);
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: #ffd700;
            color: #2d7b82;
        }

        .tab-content {
            display: none;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 5px;
        }

        .tab-content.active {
            display: block;
        }

        .setting-item {
            margin-bottom: 20px;
        }

        .setting-label {
            font-size: 10px;
            color: #ffd700;
            margin-bottom: 10px;
            display: block;
        }

        .setting-input {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #ffd700;
            color: #fff;
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            width: 200px;
        }

        .add-btn {
            background: #ffd700;
            color: #2d7b82;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .add-btn:hover {
            background: #ffed4a;
        }

        .distribution-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .distribution-input {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #ffd700;
            color: #fff;
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            width: 100px;
        }

        .delete-btn {
            background: #ff4444;
            color: #fff;
            border: none;
            padding: 5px 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #ff6666;
        }

        .submit-btn {
            background: #4CAF50;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            width: 100%;
        }

        .submit-btn:hover {
            background: #45a049;
        }

        .setting-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }

        .error-message {
            color: #ff4444;
            font-size: 10px;
            margin-top: 5px;
            display: none;
        }

        @media (max-width: 768px) {
            .page-title {
                font-size: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .control-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                flex: 1;
                min-width: 120px;
            }
        }

        /* Update popup styles to match game design */
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }

        .popup-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #2d7b82;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ffd700;
            width: 300px;
            font-family: 'Press Start 2P', cursive;
            text-align: center;
        }

        .popup-message {
            color: #fff;
            font-size: 12px;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.5;
        }

        .popup-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .popup-btn {
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            cursor: pointer;
            border: 2px solid #fff;
            background: transparent;
            color: #fff;
            min-width: 80px;
        }

        .popup-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .popup-yes {
            background: #ffd700;
            color: #2d7b82;
        }

        .popup-no {
            background: #ff4444;
        }

        .popup-ok {
            background: #ffd700;
            color: #2d7b82;
        }

        .game-settings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .game-settings-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Add new styles for telegram notify section */
        .telegram-grid {
            display: grid;
            grid-template-columns: minmax(200px, 1fr);
            gap: 10px;
            max-width: 600px;
        }

        .telegram-button-grid {
            display: grid;
            grid-template-columns: minmax(200px, 1fr);
            gap: 10px;
        }

        @media (min-width: 768px) {
            .telegram-button-grid {
                grid-template-columns: 200px 200px 120px;
            }
        }

        .telegram-input {
            width: 100%;
            max-width: 520px;
        }

        .telegram-textarea {
            width: 100%;
            max-width: 520px;
            height: 100px;
            resize: vertical;
        }

        .telegram-line-input {
            width: 60px;
        }

        @media (max-width: 768px) {
            .telegram-button-grid {
                grid-template-columns: 1fr;
            }
            
            .telegram-input,
            .telegram-textarea {
                max-width: 100%;
            }

            .telegram-line-container {
                display: flex;
                gap: 10px;
                align-items: center;
            }

            .telegram-line-input {
                flex: 1;
                max-width: 100px;
            }
        }

        /* Update telegram notify section styles */
        .telegram-button-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: flex-start;
        }

        .telegram-button-name {
            width: 200px;
        }

        .telegram-button-url {
            width: 250px;
        }

        .telegram-button-line {
            width: 60px;
        }

        @media (max-width: 768px) {
            .telegram-button-row {
                flex-direction: column;
            }
            
            .telegram-button-name,
            .telegram-button-url,
            .telegram-input,
            .telegram-textarea {
                width: 100%;
                max-width: 100%;
            }

            .telegram-button-line {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="content-container">
        <h1 class="page-title">Admin Panel</h1>

        <!-- Login Section -->
        <div class="login-section" id="loginSection">
            <button class="connect-btn" onclick="connectWallet()">Connect Wallet</button>
        </div>

        <!-- Admin Content -->
        <div class="admin-content" id="adminContent">
            <!-- Stats Section -->
            <div class="stats-section">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">Current Jackpot</div>
                        <div class="stat-value">0.00 BNB</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Reserve Jackpot</div>
                        <div class="stat-value">0.00 BNB</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">End in</div>
                        <div class="stat-value" id="roundTimer">00:00:00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Players</div>
                        <div class="stat-value">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Plays</div>
                        <div class="stat-value">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Dev Earn</div>
                        <div class="stat-value">0.00 BNB</div>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Bonus to Jackpot</div>
                    <input type="number" id="bonusInput" class="bonus-input" placeholder="0.00 BNB" step="0.01" min="0">
                    <button onclick="submitBonus()" class="control-btn" style="width: auto; margin-top: 10px;">Submit</button>
                    <button onclick="disconnectWallet()" class="control-btn" style="width: auto; margin-top: 10px; background: #ff4444;">Disconnect Wallet</button>
                </div>
            </div>

            <!-- Control Section -->
            <div class="control-section">
                <div class="control-grid">
                    <div class="control-item">
                        <button class="control-btn" onclick="togglePause(this)">Pause Game</button>
                        <input type="text" class="note-input" placeholder="Pause note...">
                    </div>
                    <div class="control-item">
                        <button class="control-btn" onclick="toggleMaintenance(this)">Maintenance</button>
                        <input type="text" class="note-input" placeholder="Maintenance note...">
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="settings-section">
                <div class="tabs">
                    <button class="tab-btn active">Blacklist Management</button>
                </div>
                <div class="tab-content active">
                    <!-- Form -->
                    <form id="blacklistForm" onsubmit="submitBlacklist(event)">
                        <div class="setting-row">
                            <div class="setting-item" style="flex: 1;">
                                <label class="setting-label">Wallet Address</label>
                                <input type="text" class="setting-input" name="walletAddress" placeholder="0x...">
                            </div>
                            <div class="setting-item" style="flex: 2;">
                                <label class="setting-label">Reason</label>
                                <input type="text" class="setting-input" name="reason" placeholder="Enter reason for blacklisting...">
                            </div>
                            <div class="setting-item" style="align-self: flex-end;">
                                <button type="submit" class="submit-btn" style="margin: 0; width: auto; padding: 10px 20px;">Blacklist</button>
                            </div>
                        </div>
                    </form>

                    <!-- Table -->
                    <div style="margin-top: 20px;">
                        <div style="margin-bottom: 10px;">
                            <div style="color: #ffd700; display: grid; grid-template-columns: 80px 200px auto 150px; gap: 10px; padding: 10px;">
                                <div>No.</div>
                                <div>Wallet</div>
                                <div>Reason</div>
                                <div>Action</div>
                            </div>
                        </div>
                        <div id="blacklistTableBody">
                            <!-- Sample row -->
                            <div style="display: grid; grid-template-columns: 80px 200px auto 150px; gap: 10px; padding: 10px; border-bottom: 1px solid rgba(255,215,0,0.1); align-items: center;">
                                <div style="color: rgba(255,255,255,0.9);">1</div>
                                <div style="color: rgba(255,255,255,0.9);">0x1234...5678</div>
                                <div style="color: rgba(255,255,255,0.9);">Sample reason for blacklisting this wallet</div>
                                <div>
                                    <button onclick="unblacklistWallet(this)" data-wallet="0x1234...5678" 
                                        style="background: transparent; color: #ffd700; border: 1px solid #ffd700; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-family: 'Press Start 2P', cursive; font-size: 0.7rem;">
                                        Unblacklist
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Update popup HTML -->
    <div class="popup-overlay" id="questionPopup">
        <div class="popup-content">
            <div class="popup-message" id="popupMessage"></div>
            <div class="popup-buttons" id="popupButtons">
                <button class="popup-btn popup-yes" onclick="handleYes()">Yes</button>
                <button class="popup-btn popup-no" onclick="closePopup()">No</button>
            </div>
        </div>
    </div>

    <script>
        let currentCallback = null;
        let isAlert = false;

        // Mock wallet connection
        function connectWallet() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
        }

        // Question popup function
        function showQuestion(message, callback) {
            document.getElementById('popupMessage').textContent = message;
            document.getElementById('questionPopup').style.display = 'block';
            
            const buttons = document.getElementById('popupButtons');
            buttons.innerHTML = `
                <button class="popup-btn popup-yes" onclick="handleYes()">Yes</button>
                <button class="popup-btn popup-no" onclick="closePopup()">No</button>
            `;
            
            currentCallback = callback;
            isAlert = false;
        }

        // Alert popup function (OK only)
        function showAlert(message) {
            document.getElementById('popupMessage').textContent = message;
            document.getElementById('questionPopup').style.display = 'block';
            
            const buttons = document.getElementById('popupButtons');
            buttons.innerHTML = `
                <button class="popup-btn popup-ok" onclick="closePopup()">OK</button>
            `;
            
            isAlert = true;
            currentCallback = null;
        }

        function handleYes() {
            if (!isAlert && currentCallback) {
                currentCallback();
            }
            closePopup();
        }

        function closePopup() {
            document.getElementById('questionPopup').style.display = 'none';
            currentCallback = null;
            isAlert = false;
        }

        // Toggle pause/maintenance buttons with question
        function togglePause(btn) {
            const action = btn.classList.contains('active') ? 'resume' : 'pause';
            showQuestion(`Do you want to ${action} the game?`, () => {
                btn.classList.toggle('active');
                btn.textContent = btn.classList.contains('active') ? 'Resume Game' : 'Pause Game';
            });
        }

        function toggleMaintenance(btn) {
            const action = btn.classList.contains('active') ? 'end' : 'start';
            showQuestion(`Do you want to ${action} maintenance?`, () => {
                btn.classList.toggle('active');
                btn.textContent = btn.classList.contains('active') ? 'End Maintenance' : 'Maintenance';
            });
        }

        // Submit bonus to jackpot with question
        function submitBonus() {
            const bonusInput = document.getElementById('bonusInput');
            const bonusAmount = bonusInput.value;

            // Validate empty input
            if (!bonusAmount || bonusAmount.trim() === '') {
                showAlert('Please enter bonus amount');
                return;
            }

            // Validate number
            if (isNaN(bonusAmount) || parseFloat(bonusAmount) <= 0) {
                showAlert('Please enter a valid positive number');
                return;
            }

            showQuestion(`Do you want to add ${bonusAmount} BNB to jackpot?`, () => {
                console.log('Adding bonus:', bonusAmount, 'BNB');
                // Here you would typically send the data to your backend
                showAlert('Bonus added successfully!');
                // Clear input after successful submission
                bonusInput.value = '';
            });
        }

        // Submit game settings with question
        function submitGameSettings(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            
            // Validate total time must be whole hours
            const totalMinutes = parseInt(data.playTime) + parseInt(data.rewardTime) + parseInt(data.prepTime);
            if (totalMinutes % 60 !== 0) {
                showAlert('Total time must be in whole hours');
                return;
            }

            showQuestion('Do you want to update game settings?', () => {
                console.log('Game Settings:', data);
                // Here you would typically send the data to your backend
                showAlert('Game settings saved!');
            });
        }

        // Submit bet settings with question
        function submitBetSettings(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            
            showQuestion('Do you want to update bet settings?', () => {
                console.log('Bet Settings:', data);
                // Here you would typically send the data to your backend
                showAlert('Bet settings saved!');
            });
        }

        // Submit distribution settings with question
        function submitDistributionSettings(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            
            // Validate total percentage = 100
            const total = Object.values(data).reduce((sum, value) => sum + Number(value), 0);
            if (total !== 100) {
                showAlert('Total distribution must equal 100%');
                return;
            }

            showQuestion('Do you want to update distribution settings?', () => {
                console.log('Distribution Settings:', data);
                // Here you would typically send the data to your backend
                showAlert('Distribution settings saved!');
            });
        }

        // Submit telegram notification with validation
        function submitTelegramNotify(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            
            // Validate image URL
            if (!data.imageUrl.trim()) {
                showAlert('Please enter image URL');
                return;
            }

            // Validate message text
            if (!data.messageText.trim()) {
                showAlert('Please enter message text');
                return;
            }

            // Validate buttons
            const buttonInputs = document.getElementById('buttonInputs');
            const buttons = buttonInputs.children;
            for (let i = 0; i < buttons.length; i++) {
                const buttonNum = i + 1;
                const nameValue = data[`btn${buttonNum}_name`];
                const linkValue = data[`btn${buttonNum}_link`];
                const lineValue = data[`btn${buttonNum}_line`];

                if (!nameValue || !nameValue.trim()) {
                    showAlert(`Please enter name for Button ${buttonNum}`);
                    return;
                }
                if (!linkValue || !linkValue.trim()) {
                    showAlert(`Please enter URL for Button ${buttonNum}`);
                    return;
                }
                if (!lineValue || lineValue < 1) {
                    showAlert(`Please enter valid line number for Button ${buttonNum}`);
                    return;
                }
            }

            // Group buttons by line
            const buttonsByLine = {};
            for (let i = 0; i < buttons.length; i++) {
                const buttonNum = i + 1;
                const line = parseInt(data[`btn${buttonNum}_line`]);
                if (!buttonsByLine[line]) {
                    buttonsByLine[line] = [];
                }
                buttonsByLine[line].push({
                    name: data[`btn${buttonNum}_name`],
                    link: data[`btn${buttonNum}_link`]
                });
            }

            // Add grouped buttons to data object
            data.buttonsByLine = buttonsByLine;
            
            showQuestion('Do you want to send this notification?', () => {
                console.log('Telegram Notification:', data);
                // Here you would typically send the data to your backend
                showAlert('Notification sent successfully!');
            });
        }

        // Add new telegram button input
        function addTelegramButton() {
            const buttonInputs = document.getElementById('buttonInputs');
            const newButton = document.createElement('div');
            newButton.className = 'setting-row';
            const buttonCount = buttonInputs.children.length + 1;
            
            newButton.innerHTML = `
                <div class="setting-item">
                    <label class="setting-label">Button ${buttonCount}</label>
                    <div class="telegram-button-row">
                        <input type="text" class="setting-input telegram-button-name" name="btn${buttonCount}_name" placeholder="Button Name">
                        <input type="url" class="setting-input telegram-button-url" name="btn${buttonCount}_link" placeholder="https://">
                        <input type="number" class="setting-input telegram-button-line" name="btn${buttonCount}_line" placeholder="Line" min="1" value="1">
                        <button type="button" class="delete-btn" onclick="deleteTelegramButton(this)">Delete</button>
                    </div>
                </div>
            `;
            
            buttonInputs.appendChild(newButton);
        }

        // Delete telegram button
        function deleteTelegramButton(btn) {
            const row = btn.closest('.setting-row');
            if (document.getElementById('buttonInputs').children.length > 1) {
                row.remove();
                renameTelegramButtons();
            } else {
                alert('Cannot delete the last button');
            }
        }

        // Rename telegram buttons after deletion
        function renameTelegramButtons() {
            const buttonInputs = document.getElementById('buttonInputs');
            const rows = buttonInputs.children;
            for (let i = 0; i < rows.length; i++) {
                const label = rows[i].querySelector('.setting-label');
                const nameInput = rows[i].querySelector('input[type="text"]');
                const linkInput = rows[i].querySelector('input[type="url"]');
                const lineInput = rows[i].querySelector('input[type="number"]');
                const buttonNum = i + 1;
                label.textContent = `Button ${buttonNum}`;
                nameInput.name = `btn${buttonNum}_name`;
                linkInput.name = `btn${buttonNum}_link`;
                lineInput.name = `btn${buttonNum}_line`;
            }
        }

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById(`${tab}Tab`).classList.add('active');
        }

        // Add new bet input with delete button
        function addBetInput() {
            const betInputs = document.getElementById('betInputs');
            const newBet = document.createElement('div');
            newBet.className = 'setting-row';
            const betCount = betInputs.children.length + 1;
            
            newBet.innerHTML = `
                <div class="setting-item">
                    <label class="setting-label">Bet ${betCount}</label>
                    <input type="number" class="setting-input" name="bet${betCount}" placeholder="0.00 BNB" step="0.01" required min="0.01">
                    <div class="error-message">Please enter a valid bet amount</div>
                </div>
                <button type="button" class="delete-btn" onclick="deleteBet(this)">Delete</button>
            `;
            
            betInputs.appendChild(newBet);
        }

        // Add new distribution input with delete button
        function addDistributionInput() {
            const distributionInputs = document.getElementById('distributionInputs');
            const newDist = document.createElement('div');
            newDist.className = 'distribution-item';
            const topCount = distributionInputs.children.length + 1;
            
            newDist.innerHTML = `
                <input type="text" class="distribution-input" value="Top ${topCount}" readonly>
                <input type="number" class="distribution-input" name="dist${topCount}" placeholder="0%" value="0" required min="0" max="100">
                <button type="button" class="delete-btn" onclick="deleteDistribution(this)">Delete</button>
                <div class="error-message">Please enter a value between 0 and 100</div>
            `;
            
            distributionInputs.appendChild(newDist);
        }

        // Delete bet row
        function deleteBet(btn) {
            const row = btn.closest('.setting-row');
            if (document.getElementById('betInputs').children.length > 1) {
                row.remove();
                renameBetInputs();
            } else {
                alert('Cannot delete the last bet setting');
            }
        }

        // Delete distribution row
        function deleteDistribution(btn) {
            const row = btn.closest('.distribution-item');
            if (document.getElementById('distributionInputs').children.length > 1) {
                row.remove();
                renameDistributionInputs();
            } else {
                alert('Cannot delete the last distribution setting');
            }
        }

        // Rename bet inputs after deletion
        function renameBetInputs() {
            const betInputs = document.getElementById('betInputs');
            const rows = betInputs.children;
            for (let i = 0; i < rows.length; i++) {
                const label = rows[i].querySelector('.setting-label');
                const input = rows[i].querySelector('.setting-input');
                label.textContent = `Bet ${i + 1}`;
                input.name = `bet${i + 1}`;
            }
        }

        // Rename distribution inputs after deletion
        function renameDistributionInputs() {
            const distributionInputs = document.getElementById('distributionInputs');
            const rows = distributionInputs.children;
            for (let i = 0; i < rows.length; i++) {
                const label = rows[i].querySelector('input[readonly]');
                const input = rows[i].querySelector('input[type="number"]');
                label.value = `Top ${i + 1}`;
                input.name = `dist${i + 1}`;
            }
        }

        // Add countdown timer function
        function updateTimer() {
            const timerElement = document.getElementById('roundTimer');
            let timeLeft = 3600; // 1 hour in seconds (you can adjust this)

            function formatTime(seconds) {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
            }

            function countdown() {
                if (timeLeft >= 0) {
                    timerElement.textContent = formatTime(timeLeft);
                    timeLeft--;
                }
            }

            // Update timer every second
            countdown();
            setInterval(countdown, 1000);
        }

        // Start the timer when page loads
        updateTimer();

        // Add blacklist related functions
        let blacklistData = []; // This will store all blacklisted wallets

        function submitBlacklist(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const walletAddress = formData.get('walletAddress');
            const reason = formData.get('reason');

            if (!walletAddress || !walletAddress.trim()) {
                showAlert('Please enter a wallet address');
                return;
            }

            if (!reason || !reason.trim()) {
                showAlert('Please enter a reason for blacklisting');
                return;
            }

            showQuestion(`Do you want to blacklist wallet ${walletAddress}?`, () => {
                console.log('Blacklisting wallet:', walletAddress, 'Reason:', reason);
                // Here you would typically send the data to your backend
                
                // Add to blacklistData array
                blacklistData.push({ wallet: walletAddress, reason: reason });
                
                // Update table
                renderBlacklistTable();
                
                form.reset();
                showAlert('Wallet has been blacklisted!');
            });
        }

        function unblacklistWallet(btn) {
            const wallet = btn.getAttribute('data-wallet');
            const item = blacklistData.find(x => x.wallet === wallet);
            if (!item) return;

            showQuestion(`Do you want to unblacklist wallet ${wallet}?\nReason for blacklist: ${item.reason}`, () => {
                console.log('Unblacklisting wallet:', wallet);
                // Here you would typically send the data to your backend
                
                // Remove from blacklistData array
                blacklistData = blacklistData.filter(x => x.wallet !== wallet);
                
                // Update table
                renderBlacklistTable();
                
                showAlert('Wallet has been unblacklisted!');
            });
        }

        function renderBlacklistTable() {
            const tableBody = document.getElementById('blacklistTableBody');
            tableBody.innerHTML = '';
            
            blacklistData.forEach((item, index) => {
                const row = document.createElement('div');
                row.style = 'display: grid; grid-template-columns: 80px 200px auto 150px; gap: 10px; padding: 10px; border-bottom: 1px solid rgba(255,215,0,0.1); align-items: center;';
                row.innerHTML = `
                    <div style="color: rgba(255,255,255,0.9);">${index + 1}</div>
                    <div style="color: rgba(255,255,255,0.9);">${item.wallet}</div>
                    <div style="color: rgba(255,255,255,0.9);">${item.reason}</div>
                    <div>
                        <button onclick="unblacklistWallet(this)" data-wallet="${item.wallet}" 
                            style="background: transparent; color: #ffd700; border: 1px solid #ffd700; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-family: 'Press Start 2P', cursive; font-size: 0.7rem;">
                            Unblacklist
                        </button>
                    </div>
                `;
                tableBody.appendChild(row);
            });
        }

        // Initialize with sample data
        blacklistData = [
            { wallet: '0x1234...5678', reason: 'Sample reason for blacklisting this wallet' }
        ];
        renderBlacklistTable();
    </script>
</body>
</html> 